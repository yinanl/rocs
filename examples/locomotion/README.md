## Reachability Control of Hybrid Locomotion Systems Based on Robust Finite Abstractions

Three simulation cases are designed to evaluate the control performance based on RFTS (Robust Finite Transition System) proposed in following archive paper:

[1][Ye Zhao, Yinan Li, Luis Sentis, Ufuk Topcu, Jun Liu, Reactive Task and Motion Planning for Robust Whole-Body Dynamic Locomotion in Constrained Environments](https://arxiv.org/abs/1811.04333)

    * Evaluation of PIPM-->PIPM walking control:
      - simulate controlled trajectories from 5 randomly chosen initial states.
      - comparison of the winning set under different disturbances
    * Comparison of control performance between the nominal control method and feedback control using robust margin sets.
    * An integrated walking control case with the walking sequence: PIPM-->PIPM-->PPM-->PIPM-->MCM-->PIPM-->PIPM.


### C++ Files for the generation of reachability control strategies.

- *walkstep.hpp*:
  1. dynamics of different modes for humanoid robots, including
    * Prismatic Inverted Pendulum Model (PIPM)
    * Prismatic Pendulum Model (PPM)
    * Stop-Launch Model (SLM)
    * Multi-contact Model (MCM)
    * Hopping Model (HM)
    * Sliding Model (SM)
  2. robust margin sets and tubes for different modes.

- *walk_pipms.cpp*: generates a control strategy from the initial to final robust margin set in PIPM (for Fig. 19 in [1]). (**Note: Make sure that a subfolder *pipms* is created before running the executable.**)
- *walk_pipm_ppm.cpp*: generates a control strategy from the initial robust margin set in PIPM to the final robust margin set in PPM (for Fig. 20 in [1]). (**Note: Make sure that a subfolder *pipm2ppm* is created before running the executable.**)
- *integrated_pipms.cpp*, *integrated_pipm_ppm.cpp*, *integrated_ppm_pipm.cpp*, *integrated_pipm_mcm.cpp*, *integrated_mcm_pipm.cpp*: generate local control strategies for the integrated case. (**Note: Make sure that subfolders *integrated/pipms_2*, *integrated/pipm2ppm*, *integrated/ppm2pipm*, *integrated/pipm2mcm*, *integrated/mcm2pipm* are created before running the executables, respectively.**)


### Matlab scripts for controlled dynamics simulation

1. Evaluation of PIPM-->PIPM walking control.
   - *setting_pipms.m*: provides the parameters used in this study case.
   - *sim_pipms.m*: simulates controlled trajectories from randomly selected initial conditions (Fig. 19 (a)).
   - *sim_pipms_varingdisturb.m*: evaluate the influence of the additive disturbance in the dynamics to the winning sets (Fig. 19 (b)).

2. Comparison of the performance of nominal control and reachability control from PIPM to PPM.
   - *setting_pipm2ppm.m*: provides the parameters.
   - *sim_pipm2ppm.m*: simulates controlled trajectories based on RFTS from randomly selected initial conditions (Fig. 20 (a)).
   - *sim_pipm2ppm_RFTS.m*: simulates control based on RFTS with different disturbances (Fig. 20 (b)).
   - *sim_pipm2ppm_nominal.m*: simulates nominal control to compare with RFTS control.

3. Simulation of integrated controlled walking.
   - *sim_integrated.m*: provide the integrated simulation framework and randomly simulated controlled trajectories (Fig. 21).
   - *sim_integrated_pipms.m*, *sim_integrated_pipm.m*, *sim_integrated_pipms.m*, *sim_integrated_pipms.m*: evaluate of local control strategies for one walking step under different modes.

4. Other function utilities
   - *plot_robustset_cells_pipm.m*, *plot_robustset_cells_ppm.m*, *plot_robustset_cells_mcm.m*: plot partitions of the robust margin sets in manifold space.
   - *vectorfield.m*: provides vectorfields for different modes (PIPM, PPM, MCM, HM).
   - *manifold.m*: convert a state in Euclidean space to the manifold space for different modes.
   - *extract_boundary2D.m*: extracts boundaries of sets, which are composed of discrete representitive points in the state space (e.g. initial set, goal set, winning sets).
   - *get_stateid.m*: returns the index of a given state in the Euclidean state space. The index generated by uniformly partition the (local) state space.
   - *simulate_trajectory.m*: simulates controlled one walking steps.